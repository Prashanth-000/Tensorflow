
# #Step 1 importing libraries
# import tensorflow as tf
# import tensorflow as tf
# from tensorflow.keras.datasets import imdb
# from tensorflow.keras.preprocessing.sequence import pad_sequences
# from tensorflow.keras.models import Sequential
# from tensorflow.keras.layers import Embedding, LSTM, Dense, Dropout
# import matplotlib.pyplot as plt

# #Step 2 Load and preprocess
# vocab = 10000
# max_len = 200

# (x_train, y_train),(x_test,y_test) = imdb.load_data(num_words=vocab)
# x_train = pad_sequences(x_train, maxlen = max_len)
# x_test = pad_sequences(x_test, maxlen = max_len)



# #Step3 Amele model na create madudu

# model = Sequential([
#   Embedding(vocab,64,input_length=max_len),
#   LSTM(64),
#   Dropout(0.5),
#   Dense(1,activation='sigmoid')
# ])

# #Compile
# model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])

# history = model.fit(x_train, y_train, epochs=1, batch_size=64, validation_split=0.2)

# # 5. Evaluate
# loss, acc = model.evaluate(x_test, y_test)
# print("Test Accuracy:", acc)

# # 6. Plot graphs

# plt.plot(history.history['accuracy'],label='Train')
# plt.plot(history.history['val_accuracy'],label='Val')
# plt.xlabel("Epoch"); plt.ylabel("Accuracy")
# plt.legend(); 
# plt.grid(); 
# plt.show()







import tensorflow as tf
from tensorflow import keras
from keras import models,layers
from keras.layers import Embedding,LSTM,Dense,Dropout
from keras.datasets import imdb
from keras.preprocessing.sequence import pad_sequences
import matplotlib.pyplot as plt
from keras.optimizers import Adam
vocab = 10000
max_len = 200

(x_train,y_train),(x_test,y_test)= imdb.load_data(num_words=vocab)
x_train = pad_sequences(x_train,maxlen= max_len)
x_test = pad_sequences(x_test,maxlen = max_len)

model = models.Sequential([
  Embedding(vocab,62,input_length=max_len),
  LSTM(62),
  Dropout(0.1),
  layers.Dense(1,activation="sigmoid")
])

model.compile(optimizer=Adam(),loss='binary_crossentropy',metrics=['accuracy'])

history = model.fit(x_train,y_train,epochs=3,batch_size=128,validation_split=0.1)

loss,acc = model.evaluate(x_test,y_test)

print("Accuracy",acc)


plt.plot(history.history['accuracy'],label="Training")
plt.plot(history.history['val_accuracy'],label = "Validation")
plt.xlabel("Epochs")
plt.ylabel("Accuracy")
plt.legend()
plt.grid()
plt.show()